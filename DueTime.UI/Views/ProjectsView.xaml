<UserControl x:Class="DueTime.UI.Views.ProjectsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:DueTime.UI"
             xmlns:vm="clr-namespace:DueTime.UI.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Projects Panel -->
        <StackPanel Grid.Column="0" Margin="10">
            <TextBlock Text="Projects" FontSize="18" FontWeight="Bold" Margin="0,0,0,10" 
                      AutomationProperties.HeadingLevel="Level1"/>
            
            <!-- New project input with proper label -->
            <Label Target="{Binding ElementName=ProjectNameTextBox}" Content="_New Project Name:" 
                  TabIndex="0"
                  AutomationProperties.Name="New Project Name Label"/>
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <TextBox x:Name="ProjectNameTextBox" Width="200" Margin="0,0,10,0" 
                         Text="{Binding NewProjectName, UpdateSourceTrigger=PropertyChanged}"
                         AutomationProperties.Name="New Project Name" 
                         AutomationProperties.HelpText="Enter a name for the new project"
                         TabIndex="1"
                         KeyDown="ProjectNameTextBox_KeyDown"/>
                <Button Content="_Add Project" 
                        Command="{Binding AddProjectCommand}"
                        IsDefault="True"
                        Click="AddProject_Click" 
                        TabIndex="2"
                        AutomationProperties.Name="Add Project Button"
                        ToolTip="Create a new project with the specified name" />
            </StackPanel>
            
            <!-- Project list with improved accessibility -->
            <Label Content="Existing Projects:" 
                  Target="{Binding ElementName=ProjectsListView}"
                  AutomationProperties.Name="Existing Projects Label"/>
            <ListView x:Name="ProjectsListView" Height="300" 
                      ItemsSource="{Binding Projects}"
                      TabIndex="3"
                      SelectedItem="{Binding SelectedProject, Mode=TwoWay}"
                      AutomationProperties.Name="Projects List">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="ID" DisplayMemberBinding="{Binding ProjectId}" Width="50"
                                       AutomationProperties.Name="Project ID Column"/>
                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="200"
                                       AutomationProperties.Name="Project Name Column"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </StackPanel>
        
        <!-- Rules Panel with improved accessibility -->
        <StackPanel Grid.Column="1" Margin="10">
            <TextBlock Text="Assignment Rules" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"
                      AutomationProperties.HeadingLevel="Level1"/>
            
            <!-- Rule pattern input with label -->
            <Label Content="_Rule Pattern (window/app contains):" 
                  Target="{Binding ElementName=RulePatternTextBox}"
                  AutomationProperties.Name="Rule Pattern Label"/>
            <TextBox x:Name="RulePatternTextBox" Width="300" Margin="0,0,0,10" 
                     Text="{Binding NewRulePattern, UpdateSourceTrigger=PropertyChanged}"
                     ToolTip="Enter a keyword to match in window titles or application names"
                     TabIndex="4"
                     AutomationProperties.Name="Rule Pattern"
                     AutomationProperties.HelpText="Enter a keyword to match in window titles or application names"
                     KeyDown="RulePatternTextBox_KeyDown"/>
            
            <!-- Helper buttons to help create rules -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Button Content="Select _Window..." 
                        Margin="0,0,10,0"
                        Padding="5,3"
                        TabIndex="5"
                        Click="OnSelectWindowClick"
                        AutomationProperties.Name="Select Window Button"
                        ToolTip="Select from a list of currently open windows to create a rule" />
                <Button Content="Select _Folder..." 
                        Margin="0,0,0,0"
                        Padding="5,3"
                        TabIndex="6"
                        Click="OnSelectFolderClick"
                        AutomationProperties.Name="Select Folder Button"
                        ToolTip="Choose a folder from your computer to create a rule" />
            </StackPanel>
            
            <!-- Project selection with label -->
            <Label Content="_Assign to Project:" 
                  Target="{Binding ElementName=ProjectsComboBox}"
                  AutomationProperties.Name="Assign to Project Label"/>
            <ComboBox x:Name="ProjectsComboBox" Width="300" Margin="0,0,0,10"
                      ItemsSource="{Binding Projects}"
                      TabIndex="7"
                      SelectedItem="{Binding SelectedProject}"
                      DisplayMemberPath="Name"
                      SelectedValuePath="ProjectId"
                      AutomationProperties.Name="Project Selection"
                      ToolTip="Select a project to assign when the pattern matches"/>
            
            <!-- Action buttons with better layout and accessibility -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Button Content="Add _Rule" 
                        Command="{Binding AddRuleCommand}"
                        Click="AddRule_Click" 
                        Margin="0,0,10,0"
                        TabIndex="8"
                        AutomationProperties.Name="Add Rule Button"
                        ToolTip="Create a new rule that assigns the selected project when a window title or application matches the pattern" />
                <Button Content="_Delete Selected Rule" 
                        Command="{Binding DeleteRuleCommand}" 
                        CommandParameter="{Binding SelectedRule}" 
                        TabIndex="9"
                        Margin="0,0,0,0"
                        AutomationProperties.Name="Delete Rule Button"
                        ToolTip="Delete the currently selected rule"/>
            </StackPanel>
            
            <!-- Rules list with improved accessibility -->
            <Label Content="Existing Rules:" 
                  Target="{Binding ElementName=RulesListView}"
                  AutomationProperties.Name="Existing Rules Label"/>
            <ListView x:Name="RulesListView" Height="218"
                      ItemsSource="{Binding Rules}"
                      TabIndex="10"
                      SelectedItem="{Binding SelectedRule, Mode=TwoWay}"
                      AutomationProperties.Name="Rules List">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="ID" DisplayMemberBinding="{Binding Id}" Width="50"
                                       AutomationProperties.Name="Rule ID Column"/>
                        <GridViewColumn Header="Pattern" DisplayMemberBinding="{Binding Pattern}" Width="150"
                                       AutomationProperties.Name="Rule Pattern Column"/>
                        <GridViewColumn Header="Project" DisplayMemberBinding="{Binding ProjectName}" Width="150"
                                       AutomationProperties.Name="Rule Project Column"/>
                    </GridView>
                </ListView.View>
                <ListView.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Delete Rule" 
                                  Command="{Binding DeleteRuleCommand}" 
                                  CommandParameter="{Binding SelectedRule}"
                                  AutomationProperties.Name="Delete Rule Menu Item"/>
                    </ContextMenu>
                </ListView.ContextMenu>
            </ListView>
        </StackPanel>
    </Grid>
</UserControl> 